import{s as _e,e as O,a as M,t as z,c as S,b as I,g as J,f as V,d as v,h as B,j as Q,k as A,l as ae,i as Y,m as u,o as x,p as K,q as W,n as le,r as ee,u as de,v as te,w as oe}from"../chunks/scheduler.BngOVlp-.js";import{e as R}from"../chunks/each.C3muy7k0.js";import{S as ge,i as me}from"../chunks/index.hdbDaAG8.js";import{u as pe,t as ve,a as be}from"../chunks/store.Btq0sn3y.js";function re(l,e,s){const o=l.slice();return o[12]=e[s],o}function ie(l,e,s){const o=l.slice();return o[6]=e[s],o}function ce(l,e,s){const o=l.slice();return o[17]=e[s],o[19]=s,o}function ue(l){let e,s=l[17]+"",o;return{c(){e=O("option"),o=z(s),this.h()},l(i){e=S(i,"OPTION",{});var r=I(e);o=B(r,s),r.forEach(v),this.h()},h(){e.__value=l[19],Q(e,e.__value)},m(i,r){Y(i,e,r),u(e,o)},p(i,r){r&1&&s!==(s=i[17]+"")&&W(o,s)},d(i){i&&v(e)}}}function he(l){let e,s=l[6]+"",o;return{c(){e=O("option"),o=z(s),this.h()},l(i){e=S(i,"OPTION",{});var r=I(e);o=B(r,s),r.forEach(v),this.h()},h(){e.__value=l[6],Q(e,e.__value)},m(i,r){Y(i,e,r),u(e,o)},p:le,d(i){i&&v(e)}}}function fe(l){var U,f;let e,s,o=((U=l[12])==null?void 0:U.image)+"",i,r,m,w=X((f=l[12])==null?void 0:f.sumDuration)+"",P,d,h,F,j,C;return{c(){e=O("div"),s=O("p"),i=z(o),r=M(),m=O("p"),P=z(w),d=M(),h=O("progress"),j=M(),C=O("div"),this.h()},l(a){e=S(a,"DIV",{});var c=I(e);s=S(c,"P",{class:!0});var p=I(s);i=B(p,o),p.forEach(v),r=V(c),m=S(c,"P",{});var T=I(m);P=B(T,w),T.forEach(v),d=V(c),h=S(c,"PROGRESS",{class:!0,max:!0}),I(h).forEach(v),c.forEach(v),j=V(a),C=S(a,"DIV",{class:!0}),I(C).forEach(v),this.h()},h(){var a;A(s,"class","w-full overflow-x-scroll"),A(h,"class","progress progress-accent w-full"),h.value=F=((a=l[12])==null?void 0:a.percentage)||0,A(h,"max","100"),A(C,"class","divider")},m(a,c){Y(a,e,c),u(e,s),u(s,i),u(e,r),u(e,m),u(m,P),u(e,d),u(e,h),Y(a,j,c),Y(a,C,c)},p(a,c){var p,T,N;c&8&&o!==(o=((p=a[12])==null?void 0:p.image)+"")&&W(i,o),c&8&&w!==(w=X((T=a[12])==null?void 0:T.sumDuration)+"")&&W(P,w),c&8&&F!==(F=((N=a[12])==null?void 0:N.percentage)||0)&&(h.value=F)},d(a){a&&(v(e),v(j),v(C))}}}function Ee(l){var se;let e,s,o="Usage",i,r,m,w="Filter by user",P,d,h,F="Filter by duration",j,C,U="Overall Usage",f,a,c,p=X((se=l[2])==null?void 0:se.totalDuration)+"",T,N,G,Z,$,ne,q=R(l[0]||[]),b=[];for(let t=0;t<q.length;t+=1)b[t]=ue(ce(l,q,t));let H=R(Object.keys(l[5])),E=[];for(let t=0;t<H.length;t+=1)E[t]=he(ie(l,H,t));let L=R(l[3]),D=[];for(let t=0;t<L.length;t+=1)D[t]=fe(re(l,L,t));return{c(){e=O("section"),s=O("h1"),s.textContent=o,i=M(),r=O("select"),m=O("option"),m.textContent=w;for(let t=0;t<b.length;t+=1)b[t].c();P=M(),d=O("select"),h=O("option"),h.textContent=F;for(let t=0;t<E.length;t+=1)E[t].c();j=M(),C=O("h2"),C.textContent=U,f=M(),a=O("div"),c=z("Total duration: "),T=z(p),N=M(),G=O("div"),Z=M();for(let t=0;t<D.length;t+=1)D[t].c();this.h()},l(t){e=S(t,"SECTION",{});var _=I(e);s=S(_,"H1",{"data-svelte-h":!0}),J(s)!=="svelte-1kso4r"&&(s.textContent=o),i=V(_),r=S(_,"SELECT",{class:!0});var g=I(r);m=S(g,"OPTION",{"data-svelte-h":!0}),J(m)!=="svelte-ujkgiu"&&(m.textContent=w);for(let y=0;y<b.length;y+=1)b[y].l(g);g.forEach(v),P=V(_),d=S(_,"SELECT",{class:!0});var n=I(d);h=S(n,"OPTION",{"data-svelte-h":!0}),J(h)!=="svelte-1fjnhjx"&&(h.textContent=F);for(let y=0;y<E.length;y+=1)E[y].l(n);n.forEach(v),j=V(_),C=S(_,"H2",{class:!0,"data-svelte-h":!0}),J(C)!=="svelte-lodfi3"&&(C.textContent=U),f=V(_),a=S(_,"DIV",{class:!0});var k=I(a);c=B(k,"Total duration: "),T=B(k,p),N=V(k),G=S(k,"DIV",{class:!0}),I(G).forEach(v),Z=V(k);for(let y=0;y<D.length;y+=1)D[y].l(k);k.forEach(v),_.forEach(v),this.h()},h(){m.__value="Filter by user",Q(m,m.__value),A(r,"class","select select-bordered"),l[1]===void 0&&ae(()=>l[7].call(r)),h.__value="Filter by duration",Q(h,h.__value),A(d,"class","select select-bordered"),l[4]===void 0&&ae(()=>l[8].call(d)),A(C,"class","mt-4"),A(G,"class","divider"),A(a,"class","border rounded-md mt-4 p-4")},m(t,_){Y(t,e,_),u(e,s),u(e,i),u(e,r),u(r,m);for(let g=0;g<b.length;g+=1)b[g]&&b[g].m(r,null);x(r,l[1],!0),u(e,P),u(e,d),u(d,h);for(let g=0;g<E.length;g+=1)E[g]&&E[g].m(d,null);x(d,l[4],!0),u(e,j),u(e,C),u(e,f),u(e,a),u(a,c),u(a,T),u(a,N),u(a,G),u(a,Z);for(let g=0;g<D.length;g+=1)D[g]&&D[g].m(a,null);$||(ne=[K(r,"change",l[7]),K(r,"change",l[6]),K(d,"change",l[8]),K(d,"change",l[6])],$=!0)},p(t,[_]){var g;if(_&1){q=R(t[0]||[]);let n;for(n=0;n<q.length;n+=1){const k=ce(t,q,n);b[n]?b[n].p(k,_):(b[n]=ue(k),b[n].c(),b[n].m(r,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=q.length}if(_&2&&x(r,t[1]),_&32){H=R(Object.keys(t[5]));let n;for(n=0;n<H.length;n+=1){const k=ie(t,H,n);E[n]?E[n].p(k,_):(E[n]=he(k),E[n].c(),E[n].m(d,null))}for(;n<E.length;n+=1)E[n].d(1);E.length=H.length}if(_&48&&x(d,t[4]),_&4&&p!==(p=X((g=t[2])==null?void 0:g.totalDuration)+"")&&W(T,p),_&8){L=R(t[3]);let n;for(n=0;n<L.length;n+=1){const k=re(t,L,n);D[n]?D[n].p(k,_):(D[n]=fe(k),D[n].c(),D[n].m(a,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=L.length}},i:le,o:le,d(t){t&&v(e),ee(b,t),ee(E,t),ee(D,t),$=!1,de(ne)}}}function X(l){const e=Math.floor(l/3600),s=Math.floor(l%3600/60),o=Math.round(l%60);let i="";return e>0&&(i+=`${e}h `),s>0&&(i+=`${s}m `),i+=`${o}s`,i.trim()}function De(l,e,s){let o,i,r;te(l,pe,f=>s(0,o=f)),te(l,ve,f=>s(9,i=f)),te(l,be,f=>s(10,r=f));let m=0,w=[],P=new Set,d={"1d":1,"1w":7,"1m":30,"3m":90,"6m":180,"1y":365},h="1m";async function F(){const f=new Date,a=new Date(f.getTime()-d[h]*24*3600*1e3),c=`${a.getDate()}-${a.getMonth()+1}-${a.getFullYear()}`,p=`${f.getDate()}-${f.getMonth()+1}-${f.getFullYear()}`,N=await(await fetch(`${r}user/predictions/`,{method:"POST",headers:{Authorization:`Bearer ${i}`},body:JSON.stringify({user:o[m],start:c,end:p})})).json();s(2,w=N),await j()}async function j(){let f=new Set,a=w.predictions.reduce((c,p)=>c+p.duration,0);for(let c=0;c<w.predictions.length;c++){const p=w.predictions[c];let T=Array.from(f).find(N=>N.image===p.image);T?T.sumDuration+=p.duration:f.add({image:p.image,sumDuration:p.duration})}f=new Set(Array.from(f).map(c=>({...c,percentage:c.sumDuration/a*100}))),s(3,P=f)}function C(){m=oe(this),s(1,m)}function U(){h=oe(this),s(4,h),s(5,d)}return l.$$.update=()=>{l.$$.dirty&1&&o.length>0&&F()},[o,m,w,P,h,d,F,C,U]}class we extends ge{constructor(e){super(),me(this,e,De,Ee,_e,{})}}export{we as component};
